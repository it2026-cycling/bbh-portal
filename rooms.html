<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BBH Portal – Rooms</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#f6f7fb;color:#111}
    header{background:#fff;border-bottom:1px solid #e6e8ef;padding:16px 20px;display:flex;align-items:center;gap:12px}
    h1{font-size:20px;margin:0}
    .pill{font-size:12px;border:1px solid #d8dbe6;background:#fff;border-radius:999px;padding:6px 10px}
    .ok{color:#0a7a2f;border-color:#bfe6cc;background:#effaf3}
    .warn{color:#8a3d00;border-color:#ffd9b0;background:#fff6eb}
    main{padding:18px 20px;max-width:1100px;margin:0 auto}
    .grid{display:grid;grid-template-columns: 360px 1fr;gap:16px}
    .card{background:#fff;border:1px solid #e6e8ef;border-radius:12px;padding:14px}
    .card h2{font-size:16px;margin:0 0 10px}
    .muted{color:#666;font-size:13px}
    .list{display:flex;flex-direction:column;gap:8px}
    .item{border:1px solid #e6e8ef;border-radius:10px;padding:10px;display:flex;justify-content:space-between;align-items:center;gap:10px}
    .btn{border:1px solid #d8dbe6;background:#fff;border-radius:10px;padding:8px 10px;cursor:pointer}
    .btn.primary{background:#111;color:#fff;border-color:#111}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px solid #eef0f6;padding:8px;text-align:left;font-size:14px}
    input,select{border:1px solid #d8dbe6;border-radius:10px;padding:8px;width:100%}
    .row{display:grid;grid-template-columns: 1fr 140px 140px 160px 120px;gap:10px;align-items:end}
    .row label{font-size:12px;color:#666;display:block;margin-bottom:6px}
    .topbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .spacer{flex:1}
    .hidden{display:none}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  </style>
</head>
<body>
  <header>
    <h1>BBH Portal – Rooms</h1>
    <span id="jsBadge" class="pill warn">JS: non ancora caricato</span>
    <span id="authBadge" class="pill warn">Auth: sconosciuta</span>
    <span id="roleBadge" class="pill">Ruolo: -</span>
    <span class="spacer"></span>
    <button id="reloadBtn" class="btn">Ricarica dati</button>
  </header>

  <main>
    <div class="grid">
      <section class="card">
        <div class="topbar">
          <h2 style="margin:0">Strutture</h2>
          <span class="muted" id="propsCount"></span>
        </div>
        <p class="muted" id="propsHint">Se qui non compare nulla, controlla /api/properties.</p>
        <div id="propsList" class="list"></div>
      </section>

      <section class="card">
        <div class="topbar">
          <h2 style="margin:0">Dettaglio</h2>
          <span class="muted" id="selectedPropMeta"></span>
          <span class="spacer"></span>
        </div>

        <div id="noSelection" class="muted">Seleziona una struttura e clicca “Dettaglio”.</div>

        <div id="detail" class="hidden">
          <div class="topbar" style="margin-bottom:10px">
            <div>
              <div style="font-weight:700" id="selectedPropName">-</div>
              <div class="muted">Property ID: <span class="mono" id="selectedPropId">-</span></div>
            </div>
            <span class="spacer"></span>
            <button id="loadRoomsBtn" class="btn primary">Carica camere</button>
          </div>

          <div class="card" style="padding:12px;border-radius:10px;margin-bottom:12px">
            <h2 style="margin:0 0 10px">Aggiungi tipo camera</h2>
            <div class="row">
              <div>
                <label>Nome</label>
                <input id="newName" placeholder="Es. Doppia" />
              </div>
              <div>
                <label>Capienza</label>
                <input id="newCapacity" type="number" min="0" step="1" placeholder="2" />
              </div>
              <div>
                <label>Quantità</label>
                <input id="newQuantity" type="number" min="0" step="1" placeholder="4" />
              </div>
              <div>
                <label>Status</label>
                <select id="newStatus">
                  <option value="active">active</option>
                  <option value="inactive">inactive</option>
                </select>
              </div>
              <div>
                <button id="createRoomBtn" class="btn primary">Crea</button>
              </div>
            </div>
            <div class="muted" style="margin-top:8px" id="createMsg"></div>
          </div>

          <h2 style="margin:0 0 10px">Camere</h2>
          <div class="muted" id="roomsHint">Clicca “Carica camere”.</div>
          <table id="roomsTable" class="hidden">
            <thead>
              <tr>
                <th>Nome</th><th>Capienza</th><th>Quantità</th><th>Status</th><th>Azioni</th>
              </tr>
            </thead>
            <tbody id="roomsTbody"></tbody>
          </table>

          <div class="muted" style="margin-top:12px" id="debugBox"></div>
        </div>
      </section>
    </div>
  </main>

  <!-- IMPORTANT: external JS to avoid CSP blocking inline scripts -->
  <script src="/rooms.js" defer></script>
</body>
</html>
